{"ast":null,"code":"import Axios from \"axios\";\nimport cartTypes from \"../cart/cartTypes\";\nimport orderTypes from \"./orderTypes\";\nexport const createOrder = cart => async (dispatch, getState) => {\n  const {\n    cartItems,\n    shippingAddress,\n    paymentMethod,\n    taxPrice,\n    shippingPrice,\n    totalPrice,\n    itemsPrice\n  } = cart;\n\n  try {\n    const token = getState().userReducer.userInfo.token;\n    dispatch({\n      type: orderTypes.CREATE_ORDER_START\n    });\n    const query = `\n      mutation CreateOrder(\n        $orderItems : String!,\n        $shippingAddress : String!,\n        $paymentMethod : String! ,\n        $taxPrice : Float!,\n        $shippingPrice: Float!,\n        $totalPrice: Float!,\n        $itemsPrice : Float!,\n        )\n        {\n            CreateOrder(\n                orderItems : $orderItems,\n                shippingAddress :  $shippingAddress,\n                paymentMethod : $paymentMethod,\n                taxPrice : $taxPrice,\n                shippingPrice: $shippingPrice,\n                totalPrice:  $totalPrice,\n                itemsPrice : $itemsPrice\n                 )\n                {\n                    _id\n                    orderItems {\n                      qty\n                      name\n                      image\n                      price\n                     \n                    }\n                   \n                    paymentMethod \n                    taxPrice \n                    shippingPrice\n                    totalPrice\n                   \n                }\n        }\n        `;\n    const orderItemsWithProductInstedOF_id = cartItems.map(item => {\n      return {\n        countInStock: item.countInStock,\n        image: item.image,\n        name: item.name,\n        price: item.price,\n        qty: item.qty,\n        product: item._id\n      };\n    });\n    const variables = {\n      orderItems: JSON.stringify(orderItemsWithProductInstedOF_id),\n      shippingAddress: JSON.stringify(shippingAddress),\n      paymentMethod,\n      taxPrice,\n      shippingPrice,\n      totalPrice,\n      itemsPrice\n    };\n    const {\n      data\n    } = await Axios.post(\"/graphql\", {\n      query,\n      variables\n    }, {\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `Bearer ${token}`\n      }\n    });\n    dispatch({\n      type: orderTypes.CREATE_ORDER_SUCCESS,\n      payload: data.data.CreateOrder\n    });\n    localStorage.setItem(\"cartItems\", null);\n    dispatch({\n      type: cartTypes.EMPTY_CART_ITEMS\n    });\n  } catch (error) {\n    const errorMessage = error.response.data.errors ? error.response.data.errors[0].message : error.response.data ? error.response.data : \"error happend\";\n    dispatch({\n      type: orderTypes.CREATE_ORDER_FAIL,\n      payload: errorMessage\n    });\n  }\n};\nexport const getOrderById = ({\n  id\n}) => async (dispatch, getState) => {\n  try {\n    const token = getState().userReducer.userInfo.token;\n    console.log(token);\n    dispatch({\n      type: orderTypes.ORDER_DETAIL_START\n    });\n    const query = `query getOrderById($id:String!){\n      getOrderById(id:$id){\n          _id\n          orderItems{\n              _id \n              name\n              qty\n              image\n              price\n              product{\n                _id\n              }\n          }\n          shippingAddress{\n               city\n               address\n               postalCode\n               country\n            }\n          itemsPrice\n          paymentMethod \n          taxPrice \n          shippingPrice\n          totalPrice\n          orderCreator{\n              _id\n              name\n              email\n          \n          }\n          createdAt\n          updatedAt\n      }\n  }`;\n    const variables = {\n      id\n    };\n    const {\n      data\n    } = await Axios.post(\"/graphql\", {\n      query,\n      variables\n    }, {\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `Bearer ${token}`\n      }\n    });\n    dispatch({\n      type: orderTypes.ORDER_DETAIL_SUCCESS,\n      payload: data.data.getOrderById\n    });\n  } catch (error) {\n    var _error$response, _error$response2, _error$response3, _error$response4;\n\n    const errorMessage = ((_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.data.errors) ? (_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : _error$response2.data.errors[0].message : ((_error$response3 = error.response) === null || _error$response3 === void 0 ? void 0 : _error$response3.data) ? (_error$response4 = error.response) === null || _error$response4 === void 0 ? void 0 : _error$response4.data : \"error happend\";\n    dispatch({\n      type: orderTypes.ORDER_DETAIL_FAIL,\n      payload: errorMessage\n    });\n  }\n};","map":{"version":3,"sources":["/mnt/d/react&bac/mern-shop/frontend/src/redux/order/orderAction.js"],"names":["Axios","cartTypes","orderTypes","createOrder","cart","dispatch","getState","cartItems","shippingAddress","paymentMethod","taxPrice","shippingPrice","totalPrice","itemsPrice","token","userReducer","userInfo","type","CREATE_ORDER_START","query","orderItemsWithProductInstedOF_id","map","item","countInStock","image","name","price","qty","product","_id","variables","orderItems","JSON","stringify","data","post","headers","Authorization","CREATE_ORDER_SUCCESS","payload","CreateOrder","localStorage","setItem","EMPTY_CART_ITEMS","error","errorMessage","response","errors","message","CREATE_ORDER_FAIL","getOrderById","id","console","log","ORDER_DETAIL_START","ORDER_DETAIL_SUCCESS","ORDER_DETAIL_FAIL"],"mappings":"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","sourcesContent":["import Axios from \"axios\"\nimport cartTypes from \"../cart/cartTypes\"\nimport orderTypes from \"./orderTypes\"\n\nexport const createOrder = (cart) => async (dispatch, getState) => {\n  const {\n    cartItems,\n    shippingAddress,\n    paymentMethod,\n    taxPrice,\n    shippingPrice,\n    totalPrice,\n    itemsPrice,\n  } = cart\n  try {\n    const token = getState().userReducer.userInfo.token\n    dispatch({\n      type: orderTypes.CREATE_ORDER_START,\n    })\n    const query = `\n      mutation CreateOrder(\n        $orderItems : String!,\n        $shippingAddress : String!,\n        $paymentMethod : String! ,\n        $taxPrice : Float!,\n        $shippingPrice: Float!,\n        $totalPrice: Float!,\n        $itemsPrice : Float!,\n        )\n        {\n            CreateOrder(\n                orderItems : $orderItems,\n                shippingAddress :  $shippingAddress,\n                paymentMethod : $paymentMethod,\n                taxPrice : $taxPrice,\n                shippingPrice: $shippingPrice,\n                totalPrice:  $totalPrice,\n                itemsPrice : $itemsPrice\n                 )\n                {\n                    _id\n                    orderItems {\n                      qty\n                      name\n                      image\n                      price\n                     \n                    }\n                   \n                    paymentMethod \n                    taxPrice \n                    shippingPrice\n                    totalPrice\n                   \n                }\n        }\n        `\n    const orderItemsWithProductInstedOF_id = cartItems.map((item) => {\n      return {\n        countInStock: item.countInStock,\n        image: item.image,\n        name: item.name,\n        price: item.price,\n        qty: item.qty,\n        product: item._id,\n      }\n    })\n    const variables = {\n      orderItems: JSON.stringify(orderItemsWithProductInstedOF_id),\n      shippingAddress: JSON.stringify(shippingAddress),\n      paymentMethod,\n      taxPrice,\n      shippingPrice,\n      totalPrice,\n      itemsPrice,\n    }\n    const { data } = await Axios.post(\n      \"/graphql\",\n      {\n        query,\n        variables,\n      },\n      {\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${token}`,\n        },\n      }\n    )\n    dispatch({\n      type: orderTypes.CREATE_ORDER_SUCCESS,\n      payload: data.data.CreateOrder,\n    })\n    localStorage.setItem(\"cartItems\", null)\n\n    dispatch({\n      type: cartTypes.EMPTY_CART_ITEMS,\n    })\n  } catch (error) {\n    const errorMessage = error.response.data.errors\n      ? error.response.data.errors[0].message\n      : error.response.data\n      ? error.response.data\n      : \"error happend\"\n    dispatch({\n      type: orderTypes.CREATE_ORDER_FAIL,\n      payload: errorMessage,\n    })\n  }\n}\n\nexport const getOrderById = ({ id }) => async (dispatch, getState) => {\n  try {\n    const token = getState().userReducer.userInfo.token\n    console.log(token)\n    dispatch({\n      type: orderTypes.ORDER_DETAIL_START,\n    })\n    const query = `query getOrderById($id:String!){\n      getOrderById(id:$id){\n          _id\n          orderItems{\n              _id \n              name\n              qty\n              image\n              price\n              product{\n                _id\n              }\n          }\n          shippingAddress{\n               city\n               address\n               postalCode\n               country\n            }\n          itemsPrice\n          paymentMethod \n          taxPrice \n          shippingPrice\n          totalPrice\n          orderCreator{\n              _id\n              name\n              email\n          \n          }\n          createdAt\n          updatedAt\n      }\n  }`\n\n    const variables = { id }\n    const { data } = await Axios.post(\n      \"/graphql\",\n      {\n        query,\n        variables,\n      },\n      {\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${token}`,\n        },\n      }\n    )\n    dispatch({\n      type: orderTypes.ORDER_DETAIL_SUCCESS,\n      payload: data.data.getOrderById,\n    })\n  } catch (error) {\n    const errorMessage = error.response?.data.errors\n      ? error.response?.data.errors[0].message\n      : error.response?.data\n      ? error.response?.data\n      : \"error happend\"\n    dispatch({\n      type: orderTypes.ORDER_DETAIL_FAIL,\n      payload: errorMessage,\n    })\n  }\n}\n"]},"metadata":{},"sourceType":"module"}